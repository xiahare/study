impala-shell -d db_log_public -B -q "show range partitions __root_facet_result;"


tbls=(`impala-shell -d db_log_public -B -q "show tables like '__*_facet_result'"`)


select 'cq8kokxf' as storageId,count(*),max(start_time) from __cq8kokxf_facet_result
union all
select 'i4malgiu',count(*),max(start_time) from __i4malgiu_facet_result
union all
select 'root',count(*),max(start_time) from __root_facet_result;

select 'cq8kokxf_new' as storageId,count(*),max(start_time) from new__cq8kokxf_facet_result
union all
select 'i4malgiu_new',count(*),max(start_time) from new__i4malgiu_facet_result
union all
select 'root_new',count(*),max(start_time) from new__root_facet_result;

select string_agg(tbl_col."COLUMN_EXP",',')  from
(select
    concat('ndv(',c."COLUMN_NAME",')') AS "COLUMN_EXP"
 from "TBLS" t, "SDS" r,"COLUMNS_V2" c
where t."SD_ID"=r."SD_ID" and r."CD_ID"=c."CD_ID" and "TBL_NAME" = '__root_facet_result' order by c."INTEGER_IDX") tbl_col;

select 
ndv(row_no),ndv(start_time),ndv(hash_id),ndv(adomid),ndv(slot),ndv(end_time),ndv(int0),ndv(int1),ndv(int2),ndv(int3),ndv(int4),ndv(int5),ndv(int6),ndv(int7),ndv(int8),ndv(int9),ndv(int10),ndv(int11),ndv(int12),ndv(int13),ndv(int14),ndv(int15),ndv(int16),ndv(int17),ndv(int18),ndv(int19),ndv(int20),ndv(int21),ndv(int22),ndv(int23),ndv(int24),ndv(int25),ndv(int26),ndv(int27),ndv(int28),ndv(int29),ndv(int30),ndv(int31),ndv(int32),ndv(int33),ndv(int34),ndv(int35),ndv(int36),ndv(int37),ndv(int38),ndv(int39),ndv(int40),ndv(int41),ndv(int42),ndv(int43),ndv(int44),ndv(int45),ndv(int46),ndv(int47),ndv(int48),ndv(int49),ndv(bigint0),ndv(bigint1),ndv(bigint2),ndv(bigint3),ndv(bigint4),ndv(bigint5),ndv(bigint6),ndv(bigint7),ndv(bigint8),ndv(bigint9),ndv(bigint10),ndv(bigint11),ndv(bigint12),ndv(bigint13),ndv(bigint14),ndv(bigint15),ndv(bigint16),ndv(bigint17),ndv(bigint18),ndv(bigint19),ndv(bigint20),ndv(bigint21),ndv(bigint22),ndv(bigint23),ndv(bigint24),ndv(bigint25),ndv(bigint26),ndv(bigint27),ndv(bigint28),ndv(bigint29),ndv(bigint30),ndv(bigint31),ndv(bigint32),ndv(bigint33),ndv(bigint34),ndv(bigint35),ndv(bigint36),ndv(bigint37),ndv(bigint38),ndv(bigint39),ndv(bigint40),ndv(bigint41),ndv(bigint42),ndv(bigint43),ndv(bigint44),ndv(bigint45),ndv(bigint46),ndv(bigint47),ndv(bigint48),ndv(bigint49),ndv(float0),ndv(float1),ndv(float2),ndv(float3),ndv(float4),ndv(float5),ndv(float6),ndv(float7),ndv(float8),ndv(float9),ndv(float10),ndv(float11),ndv(float12),ndv(float13),ndv(float14),ndv(float15),ndv(float16),ndv(float17),ndv(float18),ndv(float19),ndv(float20),ndv(float21),ndv(float22),ndv(float23),ndv(float24),ndv(float25),ndv(float26),ndv(float27),ndv(float28),ndv(float29),ndv(float30),ndv(float31),ndv(float32),ndv(float33),ndv(float34),ndv(float35),ndv(float36),ndv(float37),ndv(float38),ndv(float39),ndv(float40),ndv(float41),ndv(float42),ndv(float43),ndv(float44),ndv(float45),ndv(float46),ndv(float47),ndv(float48),ndv(float49),ndv(string0),ndv(string1),ndv(string2),ndv(string3),ndv(string4),ndv(string5),ndv(string6),ndv(string7),ndv(string8),ndv(string9),ndv(string10),ndv(string11),ndv(string12),ndv(string13),ndv(string14),ndv(string15),ndv(string16),ndv(string17),ndv(string18),ndv(string19),ndv(string20),ndv(string21),ndv(string22),ndv(string23),ndv(string24),ndv(string25),ndv(string26),ndv(string27),ndv(string28),ndv(string29),ndv(string30),ndv(string31),ndv(string32),ndv(string33),ndv(string34),ndv(string35),ndv(string36),ndv(string37),ndv(string38),ndv(string39),ndv(string40),ndv(string41),ndv(string42),ndv(string43),ndv(string44),ndv(string45),ndv(string46),ndv(string47),ndv(string48),ndv(string49),ndv(string50),ndv(string51),ndv(string52),ndv(string53),ndv(string54),ndv(string55),ndv(string56),ndv(string57),ndv(string58),ndv(string59),ndv(string60),ndv(string61),ndv(string62),ndv(string63),ndv(string64),ndv(string65),ndv(string66),ndv(string67),ndv(string68),ndv(string69),ndv(string70),ndv(string71),ndv(string72),ndv(string73),ndv(string74),ndv(string75),ndv(string76),ndv(string77),ndv(string78),ndv(string79),ndv(string80),ndv(string81),ndv(string82),ndv(string83),ndv(string84),ndv(string85),ndv(string86),ndv(string87),ndv(string88),ndv(string89),ndv(string90),ndv(string91),ndv(string92),ndv(string93),ndv(string94),ndv(string95),ndv(string96),ndv(string97),ndv(string98),ndv(string99),ndv(timestamp0),ndv(timestamp1),ndv(timestamp2),ndv(timestamp3),ndv(timestamp4),ndv(timestamp5),ndv(timestamp6),ndv(timestamp7),ndv(timestamp8),ndv(timestamp9),ndv(double0),ndv(double1),ndv(double2),ndv(double3),ndv(double4),ndv(double5),ndv(double6),ndv(double7),ndv(double8),ndv(double9),ndv(double10),ndv(double11),ndv(double12),ndv(double13),ndv(double14),ndv(double15),ndv(double16),ndv(double17),ndv(double18),ndv(double19),ndv(boolean0),ndv(boolean1),ndv(boolean2),ndv(boolean3),ndv(boolean4)
from __cq8kokxf_facet_result;

+-------------+-----------------+--------------+-------------+-----------+---------------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+-------------+-------------+-------------+-------------+-------------+-------------+-------------+-------------+-------------+-------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+
| ndv(row_no) | ndv(start_time) | ndv(hash_id) | ndv(adomid) | ndv(slot) | ndv(end_time) | ndv(int0) | ndv(int1) | ndv(int2) | ndv(int3) | ndv(int4) | ndv(int5) | ndv(int6) | ndv(int7) | ndv(int8) | ndv(int9) | ndv(int10) | ndv(int11) | ndv(int12) | ndv(int13) | ndv(int14) | ndv(int15) | ndv(int16) | ndv(int17) | ndv(int18) | ndv(int19) | ndv(int20) | ndv(int21) | ndv(int22) | ndv(int23) | ndv(int24) | ndv(int25) | ndv(int26) | ndv(int27) | ndv(int28) | ndv(int29) | ndv(int30) | ndv(int31) | ndv(int32) | ndv(int33) | ndv(int34) | ndv(int35) | ndv(int36) | ndv(int37) | ndv(int38) | ndv(int39) | ndv(int40) | ndv(int41) | ndv(int42) | ndv(int43) | ndv(int44) | ndv(int45) | ndv(int46) | ndv(int47) | ndv(int48) | ndv(int49) | ndv(bigint0) | ndv(bigint1) | ndv(bigint2) | ndv(bigint3) | ndv(bigint4) | ndv(bigint5) | ndv(bigint6) | ndv(bigint7) | ndv(bigint8) | ndv(bigint9) | ndv(bigint10) | ndv(bigint11) | ndv(bigint12) | ndv(bigint13) | ndv(bigint14) | ndv(bigint15) | ndv(bigint16) | ndv(bigint17) | ndv(bigint18) | ndv(bigint19) | ndv(bigint20) | ndv(bigint21) | ndv(bigint22) | ndv(bigint23) | ndv(bigint24) | ndv(bigint25) | ndv(bigint26) | ndv(bigint27) | ndv(bigint28) | ndv(bigint29) | ndv(bigint30) | ndv(bigint31) | ndv(bigint32) | ndv(bigint33) | ndv(bigint34) | ndv(bigint35) | ndv(bigint36) | ndv(bigint37) | ndv(bigint38) | ndv(bigint39) | ndv(bigint40) | ndv(bigint41) | ndv(bigint42) | ndv(bigint43) | ndv(bigint44) | ndv(bigint45) | ndv(bigint46) | ndv(bigint47) | ndv(bigint48) | ndv(bigint49) | ndv(float0) | ndv(float1) | ndv(float2) | ndv(float3) | ndv(float4) | ndv(float5) | ndv(float6) | ndv(float7) | ndv(float8) | ndv(float9) | ndv(float10) | ndv(float11) | ndv(float12) | ndv(float13) | ndv(float14) | ndv(float15) | ndv(float16) | ndv(float17) | ndv(float18) | ndv(float19) | ndv(float20) | ndv(float21) | ndv(float22) | ndv(float23) | ndv(float24) | ndv(float25) | ndv(float26) | ndv(float27) | ndv(float28) | ndv(float29) | ndv(float30) | ndv(float31) | ndv(float32) | ndv(float33) | ndv(float34) | ndv(float35) | ndv(float36) | ndv(float37) | ndv(float38) | ndv(float39) | ndv(float40) | ndv(float41) | ndv(float42) | ndv(float43) | ndv(float44) | ndv(float45) | ndv(float46) | ndv(float47) | ndv(float48) | ndv(float49) | ndv(string0) | ndv(string1) | ndv(string2) | ndv(string3) | ndv(string4) | ndv(string5) | ndv(string6) | ndv(string7) | ndv(string8) | ndv(string9) | ndv(string10) | ndv(string11) | ndv(string12) | ndv(string13) | ndv(string14) | ndv(string15) | ndv(string16) | ndv(string17) | ndv(string18) | ndv(string19) | ndv(string20) | ndv(string21) | ndv(string22) | ndv(string23) | ndv(string24) | ndv(string25) | ndv(string26) | ndv(string27) | ndv(string28) | ndv(string29) | ndv(string30) | ndv(string31) | ndv(string32) | ndv(string33) | ndv(string34) | ndv(string35) | ndv(string36) | ndv(string37) | ndv(string38) | ndv(string39) | ndv(string40) | ndv(string41) | ndv(string42) | ndv(string43) | ndv(string44) | ndv(string45) | ndv(string46) | ndv(string47) | ndv(string48) | ndv(string49) | ndv(string50) | ndv(string51) | ndv(string52) | ndv(string53) | ndv(string54) | ndv(string55) | ndv(string56) | ndv(string57) | ndv(string58) | ndv(string59) | ndv(string60) | ndv(string61) | ndv(string62) | ndv(string63) | ndv(string64) | ndv(string65) | ndv(string66) | ndv(string67) | ndv(string68) | ndv(string69) | ndv(string70) | ndv(string71) | ndv(string72) | ndv(string73) | ndv(string74) | ndv(string75) | ndv(string76) | ndv(string77) | ndv(string78) | ndv(string79) | ndv(string80) | ndv(string81) | ndv(string82) | ndv(string83) | ndv(string84) | ndv(string85) | ndv(string86) | ndv(string87) | ndv(string88) | ndv(string89) | ndv(string90) | ndv(string91) | ndv(string92) | ndv(string93) | ndv(string94) | ndv(string95) | ndv(string96) | ndv(string97) | ndv(string98) | ndv(string99) | ndv(timestamp0) | ndv(timestamp1) | ndv(timestamp2) | ndv(timestamp3) | ndv(timestamp4) | ndv(timestamp5) | ndv(timestamp6) | ndv(timestamp7) | ndv(timestamp8) | ndv(timestamp9) | ndv(double0) | ndv(double1) | ndv(double2) | ndv(double3) | ndv(double4) | ndv(double5) | ndv(double6) | ndv(double7) | ndv(double8) | ndv(double9) | ndv(double10) | ndv(double11) | ndv(double12) | ndv(double13) | ndv(double14) | ndv(double15) | ndv(double16) | ndv(double17) | ndv(double18) | ndv(double19) | ndv(boolean0) | ndv(boolean1) | ndv(boolean2) | ndv(boolean3) | ndv(boolean4) |
+-------------+-----------------+--------------+-------------+-----------+---------------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+-------------+-------------+-------------+-------------+-------------+-------------+-------------+-------------+-------------+-------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+
| 1170420067  | 109             | 195          | 69          | 158800    | 109           | 92744     | 7158      | 31        | 0         | 0         | 0         | 0         | 0         | 0         | 0         | 0          | 0          | 0          | 0          | 0          | 0          | 0          | 0          | 0          | 0          | 0          | 0          | 0          | 0          | 0          | 0          | 0          | 0          | 0          | 0          | 0          | 0          | 0          | 0          | 0          | 0          | 0          | 0          | 0          | 0          | 0          | 0          | 0          | 0          | 0          | 0          | 0          | 0          | 0          | 0          | 69           | 596081       | 1703846      | 1608882      | 4972328      | 3711865      | 7017256      | 2463371      | 2040022      | 2842176      | 2319693       | 1874749       | 60879513      | 52835         | 709575        | 52679         | 47117866      | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 68          | 0           | 0           | 0           | 0           | 0           | 0           | 0           | 0           | 0           | 0            | 0            | 0            | 0            | 0            | 0            | 0            | 0            | 0            | 0            | 0            | 0            | 0            | 0            | 0            | 0            | 0            | 0            | 0            | 0            | 0            | 0            | 0            | 0            | 0            | 0            | 0            | 0            | 0            | 0            | 0            | 0            | 0            | 0            | 0            | 0            | 0            | 0            | 0            | 0            | 11010        | 10290        | 12078        | 6383         | 5962         | 9769         | 110928       | 6895         | 51182        | 10576        | 6490          | 3891          | 4782          | 26266         | 1991          | 143           | 1346          | 51            | 370           | 1222          | 118386        | 363           | 14            | 103349        | 11628         | 243           | 184           | 3             | 0             | 47            | 4             | 103349        | 10643         | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 68604           | 392             | 0               | 0               | 0               | 0               | 0               | 0               | 0               | 0               | 5355         | 5247         | 1263         | 0            | 0            | 0            | 0            | 0            | 0            | 0            | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             | 0             |
+-------------+-----------------+--------------+-------------+-----------+---------------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+-----------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+-------------+-------------+-------------+-------------+-------------+-------------+-------------+-------------+-------------+-------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+--------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+---------------+

int2,bigint16,float0,string32,timestamp1,double2,boolean0
Reduced:int-10,bigint-30,float-10,string-50,timestamp-5,double-10,boolean-5

select 
    concat('ALTER TABLE __cq8kokxf_facet_result DROP `',c."COLUMN_NAME",'`;')
 from "TBLS" t, "SDS" r,"COLUMNS_V2" c  
where t."SD_ID"=r."SD_ID" and r."CD_ID"=c."CD_ID" and "TBL_NAME" = '__cq8kokxf_facet_result' order by c."INTEGER_IDX";


facet.define.insert.limit.adaptive.rule={"0":"5000000","10":"1000000","50":"500000","100":"250000","200":"100000","500":"80000","1000":"50000"}

| __1imozqvf_facet_result    |
| __4tfetkmt_facet_result    |
| __dqsvnbjk_facet_result    |
| __lhgrz3xq_facet_result    |
| __root_facet_result        |


select '__1imozqvf_facet_result' as storageId,count(*) from __1imozqvf_facet_result
union all
select '__4tfetkmt_facet_result',count(*) from __4tfetkmt_facet_result
union all
select '__dqsvnbjk_facet_result' as storageId,count(*) from __dqsvnbjk_facet_result
union all
select '__lhgrz3xq_facet_result',count(*) from __lhgrz3xq_facet_result
union all
select 'root',count(*) from __root_facet_result;


select 'CCCC',run_time,hash_id,start_time from __cq8kokxf_facet_process where start_time>'2023-09-07 0:00:00' and run_time>5 order by run_time desc limit 5
union all 
select 'IIII',run_time,hash_id,start_time from __i4malgiu_facet_process where start_time>'2023-09-07 0:00:00' and run_time>5 order by run_time desc limit 5
union all 
select 'root',run_time,hash_id,start_time from __root_facet_process where start_time>'2023-09-07 0:00:00' and run_time>5 order by run_time desc limit 5;



select 'Storage-C',avg(run_time),count(*) from __cq8kokxf_facet_process where start_time<='2023-09-14 01:20:00' and start_time>'2023-09-13 17:20:00' and run_time>5 
union all 
select 'Storage-I',avg(run_time),count(*) from __i4malgiu_facet_process where start_time<='2023-09-14 01:20:00' and start_time>'2023-09-13 17:20:00' and run_time>5 
union all 
select 'Stora-Root',avg(run_time),count(*) from __root_facet_process where start_time<='2023-09-14 01:20:00' and start_time>'2023-09-13 17:20:00' and run_time>5;


select 'Storage-C',avg(run_time),count(*) from __cq8kokxf_facet_process where start_time<='2023-09-13 17:20:00' and start_time>'2023-09-13 11:20:00' and run_time>5 
union all 
select 'Storage-I',avg(run_time),count(*) from __i4malgiu_facet_process where start_time<='2023-09-13 17:20:00' and start_time>'2023-09-13 11:20:00' and run_time>5 
union all 
select 'Stora-Root',avg(run_time),count(*) from __root_facet_process where start_time<='2023-09-13 17:20:00' and start_time>'2023-09-13 11:20:00' and run_time>5;



+--------------+------------+---------------------+
| storageid    | count(*)   | max(start_time)     |
+--------------+------------+---------------------+
| cq8kokxf_new | 922021372  | 2023-09-13 17:20:00 |
| i4malgiu_new | 1012368654 | 2023-09-13 17:20:00 |
| root_new     | 66528225   | 2023-09-13 17:20:00 |
+--------------+------------+---------------------+


-------- old ----------[ 19-hours] start_time<='2023-09-14 15:40:00' and start_time>'2023-09-13 17:20:00'
+----------+---------------+----------+
| 'Storage' | avg(run_time) | count(*) |
+----------+---------------+----------+
| Storage-C   | 16.6217320261 | 2448     |
| Storage-I   | 23.3427201917 | 3338     |
| Stora-Root  | 10.4605809129 | 482      |
+----------+---------------+----------+

-------- old ----------[ 6-hours] start_time<='2023-09-14 01:20:00' and start_time>'2023-09-13 17:20:00'
+----------+---------------+----------+
| 'Storage' | avg(run_time) | count(*) |
+----------+---------------+----------+
| Storage-C   | 16.2424623116 | 796      |
| Storage-I   | 22.7971014493 | 1104     |
| Stora-Root  | 9.02580645161 | 155      |
+----------+---------------+----------+

-------- new ----------[ 6-hours] start_time<='2023-09-13 17:20:00' and start_time>'2023-09-13 11:20:00' 
+----------+---------------+----------+
| 'Storage' | avg(run_time) | count(*) |
+----------+---------------+----------+
| Storage-C   | 15.8474295191 | 603      |
| Storage-I   | 22.7253012048 | 830      |
| Stora-Root  | 8.24137931034 | 116      |
+----------+---------------+----------+

facet.define.insert.limit.adaptive.rule={"0":"5000000","10":"1000000","50":"500000","100":"250000","200":"100000","500":"80000","1000":"50000"}


select * from (select f_user, srcip, srcuuid, group_concat(distinct srcintf, ',') as srcintf, group_concat(distinct concat(dev_src , ',' , coalesce(devtype, ' ')), '|') as dev_src_agg, group_concat(distinct concat(srcmac , ',' , devtype), '|') as mac_devtype_agg, sum(threatweight) as threatweight, sum(threat_block) as threat_block, (sum(threatweight)-sum(threat_block)) as threat_pass, sum(bandwidth) as bandwidth, sum(traffic_in) as traffic_in, sum(traffic_out) as traffic_out, sum(session_block) as session_block, sum(sessions) as sessions, (sum(sessions)-sum(session_block)) as session_pass, max(avatar) as avatar, max(epeuid) as epeuid, group_concat(distinct fortigate, ',') as fortigate, group_concat(distinct devvds, ',') as devvds from (select f_user, srcip, srcuuid, group_concat(distinct srcintf, ',') as srcintf, dev_src, max(devtype) as devtype, max(srcmac) as srcmac, sum(threatweight) as threatweight, sum(threat_block) as threat_block, (sum(threatweight)-sum(threat_block)) as threat_pass, sum(bandwidth) as bandwidth, sum(traffic_in) as traffic_in, sum(traffic_out) as traffic_out, sum(incident_block) as session_block, (sum(incidents)-sum(incident_block)) as session_pass, sum(incidents) as sessions, max(avatar) as avatar, max(epeuid) as epeuid, group_concat(distinct devid, ',') as fortigate, group_concat(distinct devvd_str(devid, vd), ',') as devvds from (select * from (select t1.*, (case when (d_flags & 1) = 1 then 'Not.Scanned' when t2.app_cat is null then 'Unknown' else t2.app_cat end) as appcat, (case when t2.risk is null then 0 else cast(t2.risk as int) end) as d_risk from ((SELECT f_user, srcip, srcuuid, srcintf, dev_src, srcmac, devtype, devid, vd, d_flags, app_group, sum(threatweight) as threatweight, sum(threat_block) as threat_block, sum(bandwidth) as bandwidth, sum(traffic_in) as traffic_in, sum(traffic_out) as traffic_out, sum(incident_block) as incident_block, sum(incidents) as incidents, max(avatar) as avatar, max(epeuid) as epeuid FROM ((select `adomid`,`devid`,`vd`,`srcintfrole`,`dstintfrole`,`timescale`,`epid`,`f_user`,`srcip`,`srcintf`,`srcuuid`,`srcmac`,`dev_src`,`dstip`,`dstintf`,`dstuuid`,`dstowner`,`dstmac`,`dstcountry`,`app_group`,`policymode`,`policyid`,`policytype`,`d_flags`,`catdesc`,`domain`,`devtype`,`avatar`,`epeuid`,`browsetime`,`accessproxy`,`crlevel`,`threatweight`,`threat_block`,`thwgt_cri`,`thwgt_hig`,`thwgt_med`,`thwgt_low`,`bandwidth`,`traffic_in`,`traffic_out`,`session_block`,`sessions`,`incident_block`,`incidents`,`row_rank` from ( SELECT start_time AS __start_time, adomid AS `adomid`, string0 AS `devid`, string1 AS `vd`, string2 AS `srcintfrole`, string3 AS `dstintfrole`, bigint1 AS `timescale`, int0 AS `epid`, string4 AS `f_user`, string5 AS `srcip`, string6 AS `srcintf`, string7 AS `srcuuid`, string8 AS `srcmac`, string9 AS `dev_src`, string10 AS `dstip`, string11 AS `dstintf`, string12 AS `dstuuid`, string13 AS `dstowner`, string14 AS `dstmac`, string15 AS `dstcountry`, string16 AS `app_group`, string17 AS `policymode`, bigint2 AS `policyid`, string18 AS `policytype`, int1 AS `d_flags`, string19 AS `catdesc`, string20 AS `domain`, string21 AS `devtype`, string22 AS `avatar`, string23 AS `epeuid`, string24 AS `browsetime`, string25 AS `accessproxy`, string26 AS `crlevel`, bigint3*(0+1) AS `threatweight`, bigint4*(0+1) AS `threat_block`, bigint5*(0+1) AS `thwgt_cri`, bigint6*(0+1) AS `thwgt_hig`, bigint7*(0+1) AS `thwgt_med`, bigint8*(0+1) AS `thwgt_low`, bigint9*(0+1) AS `bandwidth`, bigint10*(0+1) AS `traffic_in`, bigint11*(0+1) AS `traffic_out`, bigint12*(0+1) AS `session_block`, bigint13*(0+1) AS `sessions`, bigint14*(0+1) AS `incident_block`, bigint15*(0+1) AS `incidents`, bigint16 AS `row_rank` FROM __i4malgiu_facet_result WHERE hash_id=3417303864143545177) ___f_m1_3417303864143545177___  where adomid=2693 and ( (__start_time>='2023-09-14 08:30:00' and __start_time<='2023-09-14 20:59:59') ))) t WHERE (TRUE) AND (1=1) GROUP BY f_user, srcip, srcuuid, srcintf, dev_src, srcmac, devtype, devid, vd, d_flags, app_group) union all (SELECT f_user, srcip, srcuuid, srcintf, dev_src, srcmac, devtype, devid, vd, d_flags, app_group, sum(threatweight) as threatweight, sum(threat_block) as threat_block, sum(bandwidth) as bandwidth, sum(traffic_in) as traffic_in, sum(traffic_out) as traffic_out, sum(incident_block) as incident_block, sum(incidents) as incidents, max(avatar) as avatar, max(epeuid) as epeuid FROM ((select `adomid`,`devid`,`vd`,`srcintfrole`,`dstintfrole`,`timescale`,`epid`,`f_user`,`srcip`,`srcintf`,`srcuuid`,`srcmac`,`dev_src`,`dstip`,`dstintf`,`dstuuid`,`dstowner`,`dstmac`,`dstcountry`,`app_group`,`policymode`,`policyid`,`policytype`,`d_flags`,`catdesc`,`domain`,`devtype`,`avatar`,`epeuid`,`browsetime`,`accessproxy`,`crlevel`,`threatweight`,`threat_block`,`thwgt_cri`,`thwgt_hig`,`thwgt_med`,`thwgt_low`,`bandwidth`,`traffic_in`,`traffic_out`,`session_block`,`sessions`,`incident_block`,`incidents`,`row_rank` from ( SELECT start_time AS __start_time, adomid AS `adomid`, string0 AS `devid`, string1 AS `vd`, string2 AS `srcintfrole`, string3 AS `dstintfrole`, bigint1 AS `timescale`, int0 AS `epid`, string4 AS `f_user`, string5 AS `srcip`, string6 AS `srcintf`, string7 AS `srcuuid`, string8 AS `srcmac`, string9 AS `dev_src`, string10 AS `dstip`, string11 AS `dstintf`, string12 AS `dstuuid`, string13 AS `dstowner`, string14 AS `dstmac`, string15 AS `dstcountry`, string16 AS `app_group`, string17 AS `policymode`, int1 AS `policyid`, string18 AS `policytype`, int2 AS `d_flags`, string19 AS `catdesc`, string20 AS `domain`, string21 AS `devtype`, string22 AS `avatar`, string23 AS `epeuid`, string24 AS `browsetime`, string25 AS `accessproxy`, string26 AS `crlevel`, bigint2*(0+1) AS `threatweight`, bigint3*(0+1) AS `threat_block`, bigint4*(0+1) AS `thwgt_cri`, bigint5*(0+1) AS `thwgt_hig`, bigint6*(0+1) AS `thwgt_med`, bigint7*(0+1) AS `thwgt_low`, int3*(0+1) AS `bandwidth`, int4*(0+1) AS `traffic_in`, int5*(0+1) AS `traffic_out`, int6*(0+1) AS `session_block`, int7*(0+1) AS `sessions`, bigint8*(0+1) AS `incident_block`, bigint9*(0+1) AS `incidents`, bigint10 AS `row_rank` FROM __i4malgiu_facet_result WHERE hash_id=6460981797477396585) ___f_m1_6460981797477396585___  where adomid=2693 and ( (__start_time>='2023-09-14 08:30:00' and __start_time<='2023-09-14 20:59:59') ))) t WHERE (TRUE) AND (1=1) GROUP BY f_user, srcip, srcuuid, srcintf, dev_src, srcmac, devtype, devid, vd, d_flags, app_group)) t1 left join app_mdata t2 on t1.app_group=t2.name) t where (TRUE)) t group by f_user, srcip, srcuuid, dev_src having sum(bandwidth)>0 or sum(incidents)>0) t1 group by f_user, srcip, srcuuid order by `sessions` desc limit 100 ) t;





select * from (select f_user, srcip, srcuuid, group_concat(distinct srcintf, ',') as srcintf, group_concat(distinct concat(dev_src , ',' , coalesce(devtype, ' ')), '|') as dev_src_agg, group_concat(distinct concat(srcmac , ',' , devtype), '|') as mac_devtype_agg, sum(threatweight) as threatweight, sum(threat_block) as threat_block, (sum(threatweight)-sum(threat_block)) as threat_pass, sum(bandwidth) as bandwidth, sum(traffic_in) as traffic_in, sum(traffic_out) as traffic_out, sum(session_block) as session_block, sum(sessions) as sessions, (sum(sessions)-sum(session_block)) as session_pass, max(avatar) as avatar, max(epeuid) as epeuid, group_concat(distinct fortigate, ',') as fortigate, group_concat(distinct devvds, ',') as devvds from (select f_user, srcip, srcuuid, group_concat(distinct srcintf, ',') as srcintf, dev_src, max(devtype) as devtype, max(srcmac) as srcmac, sum(threatweight) as threatweight, sum(threat_block) as threat_block, (sum(threatweight)-sum(threat_block)) as threat_pass, sum(bandwidth) as bandwidth, sum(traffic_in) as traffic_in, sum(traffic_out) as traffic_out, sum(incident_block) as session_block, (sum(incidents)-sum(incident_block)) as session_pass, sum(incidents) as sessions, max(avatar) as avatar, max(epeuid) as epeuid, group_concat(distinct devid, ',') as fortigate, group_concat(distinct devvd_str(devid, vd), ',') as devvds from (select * from (select t1.*, (case when (d_flags & 1) = 1 then 'Not.Scanned' when t2.app_cat is null then 'Unknown' else t2.app_cat end) as appcat, (case when t2.risk is null then 0 else cast(t2.risk as int) end) as d_risk from ((SELECT f_user, srcip, srcuuid, srcintf, dev_src, srcmac, devtype, devid, vd, d_flags, app_group, sum(threatweight) as threatweight, sum(threat_block) as threat_block, sum(bandwidth) as bandwidth, sum(traffic_in) as traffic_in, sum(traffic_out) as traffic_out, sum(incident_block) as incident_block, sum(incidents) as incidents, max(avatar) as avatar, max(epeuid) as epeuid FROM ((select `adomid`,`devid`,`vd`,`srcintfrole`,`dstintfrole`,`timescale`,`epid`,`f_user`,`srcip`,`srcintf`,`srcuuid`,`srcmac`,`dev_src`,`dstip`,`dstintf`,`dstuuid`,`dstowner`,`dstmac`,`dstcountry`,`app_group`,`policymode`,`policyid`,`policytype`,`d_flags`,`catdesc`,`domain`,`devtype`,`avatar`,`epeuid`,`browsetime`,`accessproxy`,`crlevel`,`threatweight`,`threat_block`,`thwgt_cri`,`thwgt_hig`,`thwgt_med`,`thwgt_low`,`bandwidth`,`traffic_in`,`traffic_out`,`session_block`,`sessions`,`incident_block`,`incidents`,`row_rank` from ( SELECT start_time AS __start_time, adomid AS `adomid`, string0 AS `devid`, string1 AS `vd`, string2 AS `srcintfrole`, string3 AS `dstintfrole`, bigint1 AS `timescale`, int0 AS `epid`, string4 AS `f_user`, string5 AS `srcip`, string6 AS `srcintf`, string7 AS `srcuuid`, string8 AS `srcmac`, string9 AS `dev_src`, string10 AS `dstip`, string11 AS `dstintf`, string12 AS `dstuuid`, string13 AS `dstowner`, string14 AS `dstmac`, string15 AS `dstcountry`, string16 AS `app_group`, string17 AS `policymode`, bigint2 AS `policyid`, string18 AS `policytype`, int1 AS `d_flags`, string19 AS `catdesc`, string20 AS `domain`, string21 AS `devtype`, string22 AS `avatar`, string23 AS `epeuid`, string24 AS `browsetime`, string25 AS `accessproxy`, string26 AS `crlevel`, bigint3*(0+1) AS `threatweight`, bigint4*(0+1) AS `threat_block`, bigint5*(0+1) AS `thwgt_cri`, bigint6*(0+1) AS `thwgt_hig`, bigint7*(0+1) AS `thwgt_med`, bigint8*(0+1) AS `thwgt_low`, bigint9*(0+1) AS `bandwidth`, bigint10*(0+1) AS `traffic_in`, bigint11*(0+1) AS `traffic_out`, bigint12*(0+1) AS `session_block`, bigint13*(0+1) AS `sessions`, bigint14*(0+1) AS `incident_block`, bigint15*(0+1) AS `incidents`, bigint16 AS `row_rank` FROM __i4malgiu_facet_result WHERE hash_id=3417303864143545177) ___f_m1_3417303864143545177___  where adomid=2693 and ( (__start_time>='2023-09-14 08:30:00' and __start_time<='2023-09-14 20:59:59') ))) t WHERE (TRUE) AND (1=1) GROUP BY f_user, srcip, srcuuid, srcintf, dev_src, srcmac, devtype, devid, vd, d_flags, app_group) union all (SELECT f_user, srcip, srcuuid, srcintf, dev_src, srcmac, devtype, devid, vd, d_flags, app_group, sum(threatweight) as threatweight, sum(threat_block) as threat_block, sum(bandwidth) as bandwidth, sum(traffic_in) as traffic_in, sum(traffic_out) as traffic_out, sum(incident_block) as incident_block, sum(incidents) as incidents, max(avatar) as avatar, max(epeuid) as epeuid FROM ((select `adomid`,`devid`,`vd`,`srcintfrole`,`dstintfrole`,`timescale`,`epid`,`f_user`,`srcip`,`srcintf`,`srcuuid`,`srcmac`,`dev_src`,`dstip`,`dstintf`,`dstuuid`,`dstowner`,`dstmac`,`dstcountry`,`app_group`,`policymode`,`policyid`,`policytype`,`d_flags`,`catdesc`,`domain`,`devtype`,`avatar`,`epeuid`,`browsetime`,`accessproxy`,`crlevel`,`threatweight`,`threat_block`,`thwgt_cri`,`thwgt_hig`,`thwgt_med`,`thwgt_low`,`bandwidth`,`traffic_in`,`traffic_out`,`session_block`,`sessions`,`incident_block`,`incidents`,`row_rank` from ( SELECT start_time AS __start_time, adomid AS `adomid`, string0 AS `devid`, string1 AS `vd`, string2 AS `srcintfrole`, string3 AS `dstintfrole`, bigint1 AS `timescale`, int0 AS `epid`, string4 AS `f_user`, string5 AS `srcip`, string6 AS `srcintf`, string7 AS `srcuuid`, string8 AS `srcmac`, string9 AS `dev_src`, string10 AS `dstip`, string11 AS `dstintf`, string12 AS `dstuuid`, string13 AS `dstowner`, string14 AS `dstmac`, string15 AS `dstcountry`, string16 AS `app_group`, string17 AS `policymode`, int1 AS `policyid`, string18 AS `policytype`, int2 AS `d_flags`, string19 AS `catdesc`, string20 AS `domain`, string21 AS `devtype`, string22 AS `avatar`, string23 AS `epeuid`, string24 AS `browsetime`, string25 AS `accessproxy`, string26 AS `crlevel`, bigint2*(0+1) AS `threatweight`, bigint3*(0+1) AS `threat_block`, bigint4*(0+1) AS `thwgt_cri`, bigint5*(0+1) AS `thwgt_hig`, bigint6*(0+1) AS `thwgt_med`, bigint7*(0+1) AS `thwgt_low`, int3*(0+1) AS `bandwidth`, int4*(0+1) AS `traffic_in`, int5*(0+1) AS `traffic_out`, int6*(0+1) AS `session_block`, int7*(0+1) AS `sessions`, bigint8*(0+1) AS `incident_block`, bigint9*(0+1) AS `incidents`, bigint10 AS `row_rank` FROM __i4malgiu_facet_result WHERE hash_id=6460981797477396585) ___f_m1_6460981797477396585___  where adomid=2693 and ( (__start_time>='2023-09-14 08:30:00' and __start_time<='2023-09-14 20:59:59') ))) t WHERE (TRUE) AND (1=1) GROUP BY f_user, srcip, srcuuid, srcintf, dev_src, srcmac, devtype, devid, vd, d_flags, app_group)) t1 left join app_mdata t2 on t1.app_group=t2.name) t where (TRUE)) t group by f_user, srcip, srcuuid, dev_src having sum(bandwidth)>0 or sum(incidents)>0) t1 group by f_user, srcip, srcuuid order by `sessions` desc limit 100 ) t;


-- remove 
sudo -u kudu kudu tablet unsafe_replace_tablet 198.18.1.2,198.18.1.3,198.18.1.4 05ceda90f29d475cafcd23fd3c381499

-- recovery
sudo -u kudu kudu remote_replica unsafe_change_config blade-198-18-1-10:7050 10d34baba2ea472c839d823401c46369 0768d07e01fb408f8accbd00053429e4
10d34baba2ea472c839d823401c46369 is the tablet id
0768d07e01fb408f8accbd00053429e4 is the running tserver id, ( not RUNNING is not accepted )


    |new__cq8kokxf_facet_result
    |new__i4malgiu_facet_result
    |new__root_facet_result
    
    
    
impala-shell -d db_log_public -B -q "ALTER TABLE new__cq8kokxf_facet_result rename to new_reduced__cq8kokxf_facet_result"
impala-shell -d db_log_public -B -q "ALTER TABLE new__i4malgiu_facet_result rename to new_reduced__i4malgiu_facet_result"
impala-shell -d db_log_public -B -q "ALTER TABLE new__root_facet_result rename to new_reduced__root_facet_result"


impala-shell -d db_log_public -B -q "ALTER TABLE __cq8kokxf_facet_result rename to new_more__cq8kokxf_facet_result"
impala-shell -d db_log_public -B -q "ALTER TABLE __i4malgiu_facet_result rename to new_more__i4malgiu_facet_result"
impala-shell -d db_log_public -B -q "ALTER TABLE __root_facet_result rename to new_more__root_facet_result"

    
select hash_id,row_no,start_time,adomid from __root_facet_result where start_time<='2023-09-15 17:20:00' and start_time>'2023-09-15 16:20:00' and hash_id=1366050829079526822 and adomid=2782 and start_time='2023-09-15 16:30:00' limit 100;

2023-09-11T00:00:00.000000Z <= VALUES < 2023-09-18T00:00:00.000000Z

| __cq8kokxf_fgt_traffic |
| __i4malgiu_fgt_traffic |
| __root_fgt_traffic     |

alter table __root_fgt_traffic drop range partition '2023-09-11T00:00:00.000000Z' <= VALUES < '2023-09-18T00:00:00.000000Z';


alter table __root_fgt_traffic add range partition '2023-09-11T00:00:00.000000Z' <= VALUES < '2023-09-11T08:00:00.000000Z';
alter table __root_fgt_traffic add range partition '2023-09-11T08:00:00.000000Z' <= VALUES < '2023-09-11T16:00:00.000000Z';
alter table __root_fgt_traffic add range partition '2023-09-11T16:00:00.000000Z' <= VALUES < '2023-09-12T00:00:00.000000Z';
alter table __root_fgt_traffic add range partition '2023-09-12T00:00:00.000000Z' <= VALUES < '2023-09-12T08:00:00.000000Z';
alter table __root_fgt_traffic add range partition '2023-09-12T08:00:00.000000Z' <= VALUES < '2023-09-12T16:00:00.000000Z';
alter table __root_fgt_traffic add range partition '2023-09-12T16:00:00.000000Z' <= VALUES < '2023-09-13T00:00:00.000000Z';
alter table __root_fgt_traffic add range partition '2023-09-13T00:00:00.000000Z' <= VALUES < '2023-09-13T08:00:00.000000Z';
alter table __root_fgt_traffic add range partition '2023-09-13T08:00:00.000000Z' <= VALUES < '2023-09-13T16:00:00.000000Z';
alter table __root_fgt_traffic add range partition '2023-09-13T16:00:00.000000Z' <= VALUES < '2023-09-14T00:00:00.000000Z';
alter table __root_fgt_traffic add range partition '2023-09-14T00:00:00.000000Z' <= VALUES < '2023-09-14T08:00:00.000000Z';
alter table __root_fgt_traffic add range partition '2023-09-14T08:00:00.000000Z' <= VALUES < '2023-09-14T16:00:00.000000Z';
alter table __root_fgt_traffic add range partition '2023-09-14T16:00:00.000000Z' <= VALUES < '2023-09-15T00:00:00.000000Z';
alter table __root_fgt_traffic add range partition '2023-09-15T00:00:00.000000Z' <= VALUES < '2023-09-15T08:00:00.000000Z';
alter table __root_fgt_traffic add range partition '2023-09-15T08:00:00.000000Z' <= VALUES < '2023-09-15T16:00:00.000000Z';
alter table __root_fgt_traffic add range partition '2023-09-15T16:00:00.000000Z' <= VALUES < '2023-09-16T00:00:00.000000Z';
alter table __root_fgt_traffic add range partition '2023-09-16T00:00:00.000000Z' <= VALUES < '2023-09-16T08:00:00.000000Z';
alter table __root_fgt_traffic add range partition '2023-09-16T08:00:00.000000Z' <= VALUES < '2023-09-16T16:00:00.000000Z';
alter table __root_fgt_traffic add range partition '2023-09-16T16:00:00.000000Z' <= VALUES < '2023-09-17T00:00:00.000000Z';
alter table __root_fgt_traffic add range partition '2023-09-17T00:00:00.000000Z' <= VALUES < '2023-09-17T08:00:00.000000Z';
alter table __root_fgt_traffic add range partition '2023-09-17T08:00:00.000000Z' <= VALUES < '2023-09-17T16:00:00.000000Z';
alter table __root_fgt_traffic add range partition '2023-09-17T16:00:00.000000Z' <= VALUES < '2023-09-18T00:00:00.000000Z';

__i4malgiu_fgt_traffic
2023-09-10T16:00:00.000000Z <= VALUES < 2023-09-17T16:00:00.000000Z

alter table __i4malgiu_fgt_traffic drop range partition '2023-09-10T16:00:00.000000Z' <= VALUES < '2023-09-17T16:00:00.000000Z';


alter table __i4malgiu_fgt_traffic add range partition '2023-09-10T16:00:00.000000Z' <= VALUES < '2023-09-11T00:00:00.000000Z';
alter table __i4malgiu_fgt_traffic add range partition '2023-09-11T00:00:00.000000Z' <= VALUES < '2023-09-11T08:00:00.000000Z';
alter table __i4malgiu_fgt_traffic add range partition '2023-09-11T08:00:00.000000Z' <= VALUES < '2023-09-11T16:00:00.000000Z';
alter table __i4malgiu_fgt_traffic add range partition '2023-09-11T16:00:00.000000Z' <= VALUES < '2023-09-12T00:00:00.000000Z';
alter table __i4malgiu_fgt_traffic add range partition '2023-09-12T00:00:00.000000Z' <= VALUES < '2023-09-12T08:00:00.000000Z';
alter table __i4malgiu_fgt_traffic add range partition '2023-09-12T08:00:00.000000Z' <= VALUES < '2023-09-12T16:00:00.000000Z';
alter table __i4malgiu_fgt_traffic add range partition '2023-09-12T16:00:00.000000Z' <= VALUES < '2023-09-13T00:00:00.000000Z';
alter table __i4malgiu_fgt_traffic add range partition '2023-09-13T00:00:00.000000Z' <= VALUES < '2023-09-13T08:00:00.000000Z';
alter table __i4malgiu_fgt_traffic add range partition '2023-09-13T08:00:00.000000Z' <= VALUES < '2023-09-13T16:00:00.000000Z';
alter table __i4malgiu_fgt_traffic add range partition '2023-09-13T16:00:00.000000Z' <= VALUES < '2023-09-14T00:00:00.000000Z';
alter table __i4malgiu_fgt_traffic add range partition '2023-09-14T00:00:00.000000Z' <= VALUES < '2023-09-14T08:00:00.000000Z';
alter table __i4malgiu_fgt_traffic add range partition '2023-09-14T08:00:00.000000Z' <= VALUES < '2023-09-14T16:00:00.000000Z';
alter table __i4malgiu_fgt_traffic add range partition '2023-09-14T16:00:00.000000Z' <= VALUES < '2023-09-15T00:00:00.000000Z';
alter table __i4malgiu_fgt_traffic add range partition '2023-09-15T00:00:00.000000Z' <= VALUES < '2023-09-15T08:00:00.000000Z';
alter table __i4malgiu_fgt_traffic add range partition '2023-09-15T08:00:00.000000Z' <= VALUES < '2023-09-15T16:00:00.000000Z';
alter table __i4malgiu_fgt_traffic add range partition '2023-09-15T16:00:00.000000Z' <= VALUES < '2023-09-16T00:00:00.000000Z';
alter table __i4malgiu_fgt_traffic add range partition '2023-09-16T00:00:00.000000Z' <= VALUES < '2023-09-16T08:00:00.000000Z';
alter table __i4malgiu_fgt_traffic add range partition '2023-09-16T08:00:00.000000Z' <= VALUES < '2023-09-16T16:00:00.000000Z';
alter table __i4malgiu_fgt_traffic add range partition '2023-09-16T16:00:00.000000Z' <= VALUES < '2023-09-17T00:00:00.000000Z';
alter table __i4malgiu_fgt_traffic add range partition '2023-09-17T00:00:00.000000Z' <= VALUES < '2023-09-17T08:00:00.000000Z';
alter table __i4malgiu_fgt_traffic add range partition '2023-09-17T08:00:00.000000Z' <= VALUES < '2023-09-17T16:00:00.000000Z';

__cq8kokxf_fgt_traffic
2023-09-10T16:00:00.000000Z <= VALUES < 2023-09-17T16:00:00.000000Z

alter table __cq8kokxf_fgt_traffic drop range partition '2023-09-10T16:00:00.000000Z' <= VALUES < '2023-09-17T16:00:00.000000Z';


alter table __cq8kokxf_fgt_traffic add range partition '2023-09-10T16:00:00.000000Z' <= VALUES < '2023-09-11T00:00:00.000000Z';
alter table __cq8kokxf_fgt_traffic add range partition '2023-09-11T00:00:00.000000Z' <= VALUES < '2023-09-11T08:00:00.000000Z';
alter table __cq8kokxf_fgt_traffic add range partition '2023-09-11T08:00:00.000000Z' <= VALUES < '2023-09-11T16:00:00.000000Z';
alter table __cq8kokxf_fgt_traffic add range partition '2023-09-11T16:00:00.000000Z' <= VALUES < '2023-09-12T00:00:00.000000Z';
alter table __cq8kokxf_fgt_traffic add range partition '2023-09-12T00:00:00.000000Z' <= VALUES < '2023-09-12T08:00:00.000000Z';
alter table __cq8kokxf_fgt_traffic add range partition '2023-09-12T08:00:00.000000Z' <= VALUES < '2023-09-12T16:00:00.000000Z';
alter table __cq8kokxf_fgt_traffic add range partition '2023-09-12T16:00:00.000000Z' <= VALUES < '2023-09-13T00:00:00.000000Z';
alter table __cq8kokxf_fgt_traffic add range partition '2023-09-13T00:00:00.000000Z' <= VALUES < '2023-09-13T08:00:00.000000Z';
alter table __cq8kokxf_fgt_traffic add range partition '2023-09-13T08:00:00.000000Z' <= VALUES < '2023-09-13T16:00:00.000000Z';
alter table __cq8kokxf_fgt_traffic add range partition '2023-09-13T16:00:00.000000Z' <= VALUES < '2023-09-14T00:00:00.000000Z';
alter table __cq8kokxf_fgt_traffic add range partition '2023-09-14T00:00:00.000000Z' <= VALUES < '2023-09-14T08:00:00.000000Z';
alter table __cq8kokxf_fgt_traffic add range partition '2023-09-14T08:00:00.000000Z' <= VALUES < '2023-09-14T16:00:00.000000Z';
alter table __cq8kokxf_fgt_traffic add range partition '2023-09-14T16:00:00.000000Z' <= VALUES < '2023-09-15T00:00:00.000000Z';
alter table __cq8kokxf_fgt_traffic add range partition '2023-09-15T00:00:00.000000Z' <= VALUES < '2023-09-15T08:00:00.000000Z';
alter table __cq8kokxf_fgt_traffic add range partition '2023-09-15T08:00:00.000000Z' <= VALUES < '2023-09-15T16:00:00.000000Z';
alter table __cq8kokxf_fgt_traffic add range partition '2023-09-15T16:00:00.000000Z' <= VALUES < '2023-09-16T00:00:00.000000Z';
alter table __cq8kokxf_fgt_traffic add range partition '2023-09-16T00:00:00.000000Z' <= VALUES < '2023-09-16T08:00:00.000000Z';
alter table __cq8kokxf_fgt_traffic add range partition '2023-09-16T08:00:00.000000Z' <= VALUES < '2023-09-16T16:00:00.000000Z';
alter table __cq8kokxf_fgt_traffic add range partition '2023-09-16T16:00:00.000000Z' <= VALUES < '2023-09-17T00:00:00.000000Z';
alter table __cq8kokxf_fgt_traffic add range partition '2023-09-17T00:00:00.000000Z' <= VALUES < '2023-09-17T08:00:00.000000Z';
alter table __cq8kokxf_fgt_traffic add range partition '2023-09-17T08:00:00.000000Z' <= VALUES < '2023-09-17T16:00:00.000000Z';



__root_facet_result


alter table __root_fgt_traffic drop range partition '2023-09-11T00:00:00.000000Z' <= VALUES < '2023-09-18T00:00:00.000000Z';


alter table __root_fgt_traffic add range partition '2023-09-11T00:00:00.000000Z' <= VALUES < '2023-09-11T08:00:00.000000Z';
alter table __root_fgt_traffic add range partition '2023-09-11T08:00:00.000000Z' <= VALUES < '2023-09-11T16:00:00.000000Z';
alter table __root_fgt_traffic add range partition '2023-09-11T16:00:00.000000Z' <= VALUES < '2023-09-12T00:00:00.000000Z';
alter table __root_fgt_traffic add range partition '2023-09-12T00:00:00.000000Z' <= VALUES < '2023-09-12T08:00:00.000000Z';
alter table __root_fgt_traffic add range partition '2023-09-12T08:00:00.000000Z' <= VALUES < '2023-09-12T16:00:00.000000Z';
alter table __root_fgt_traffic add range partition '2023-09-12T16:00:00.000000Z' <= VALUES < '2023-09-13T00:00:00.000000Z';
alter table __root_fgt_traffic add range partition '2023-09-13T00:00:00.000000Z' <= VALUES < '2023-09-13T08:00:00.000000Z';
alter table __root_fgt_traffic add range partition '2023-09-13T08:00:00.000000Z' <= VALUES < '2023-09-13T16:00:00.000000Z';
alter table __root_fgt_traffic add range partition '2023-09-13T16:00:00.000000Z' <= VALUES < '2023-09-14T00:00:00.000000Z';
alter table __root_fgt_traffic add range partition '2023-09-14T00:00:00.000000Z' <= VALUES < '2023-09-14T08:00:00.000000Z';
alter table __root_fgt_traffic add range partition '2023-09-14T08:00:00.000000Z' <= VALUES < '2023-09-14T16:00:00.000000Z';
alter table __root_fgt_traffic add range partition '2023-09-14T16:00:00.000000Z' <= VALUES < '2023-09-15T00:00:00.000000Z';
alter table __root_fgt_traffic add range partition '2023-09-15T00:00:00.000000Z' <= VALUES < '2023-09-15T08:00:00.000000Z';
alter table __root_fgt_traffic add range partition '2023-09-15T08:00:00.000000Z' <= VALUES < '2023-09-15T16:00:00.000000Z';
alter table __root_fgt_traffic add range partition '2023-09-15T16:00:00.000000Z' <= VALUES < '2023-09-16T00:00:00.000000Z';
alter table __root_fgt_traffic add range partition '2023-09-16T00:00:00.000000Z' <= VALUES < '2023-09-16T08:00:00.000000Z';
alter table __root_fgt_traffic add range partition '2023-09-16T08:00:00.000000Z' <= VALUES < '2023-09-16T16:00:00.000000Z';
alter table __root_fgt_traffic add range partition '2023-09-16T16:00:00.000000Z' <= VALUES < '2023-09-17T00:00:00.000000Z';
alter table __root_fgt_traffic add range partition '2023-09-17T00:00:00.000000Z' <= VALUES < '2023-09-17T08:00:00.000000Z';
alter table __root_fgt_traffic add range partition '2023-09-17T08:00:00.000000Z' <= VALUES < '2023-09-17T16:00:00.000000Z';
alter table __root_fgt_traffic add range partition '2023-09-17T16:00:00.000000Z' <= VALUES < '2023-09-18T00:00:00.000000Z';


__cq8kokxf_facet_result

alter table __cq8kokxf_fgt_traffic drop range partition '2023-09-10T16:00:00.000000Z' <= VALUES < '2023-09-17T16:00:00.000000Z';


alter table __cq8kokxf_fgt_traffic add range partition '2023-09-10T16:00:00.000000Z' <= VALUES < '2023-09-11T00:00:00.000000Z';
alter table __cq8kokxf_fgt_traffic add range partition '2023-09-11T00:00:00.000000Z' <= VALUES < '2023-09-11T08:00:00.000000Z';
alter table __cq8kokxf_fgt_traffic add range partition '2023-09-11T08:00:00.000000Z' <= VALUES < '2023-09-11T16:00:00.000000Z';
alter table __cq8kokxf_fgt_traffic add range partition '2023-09-11T16:00:00.000000Z' <= VALUES < '2023-09-12T00:00:00.000000Z';
alter table __cq8kokxf_fgt_traffic add range partition '2023-09-12T00:00:00.000000Z' <= VALUES < '2023-09-12T08:00:00.000000Z';
alter table __cq8kokxf_fgt_traffic add range partition '2023-09-12T08:00:00.000000Z' <= VALUES < '2023-09-12T16:00:00.000000Z';
alter table __cq8kokxf_fgt_traffic add range partition '2023-09-12T16:00:00.000000Z' <= VALUES < '2023-09-13T00:00:00.000000Z';
alter table __cq8kokxf_fgt_traffic add range partition '2023-09-13T00:00:00.000000Z' <= VALUES < '2023-09-13T08:00:00.000000Z';
alter table __cq8kokxf_fgt_traffic add range partition '2023-09-13T08:00:00.000000Z' <= VALUES < '2023-09-13T16:00:00.000000Z';
alter table __cq8kokxf_fgt_traffic add range partition '2023-09-13T16:00:00.000000Z' <= VALUES < '2023-09-14T00:00:00.000000Z';
alter table __cq8kokxf_fgt_traffic add range partition '2023-09-14T00:00:00.000000Z' <= VALUES < '2023-09-14T08:00:00.000000Z';
alter table __cq8kokxf_fgt_traffic add range partition '2023-09-14T08:00:00.000000Z' <= VALUES < '2023-09-14T16:00:00.000000Z';
alter table __cq8kokxf_fgt_traffic add range partition '2023-09-14T16:00:00.000000Z' <= VALUES < '2023-09-15T00:00:00.000000Z';
alter table __cq8kokxf_fgt_traffic add range partition '2023-09-15T00:00:00.000000Z' <= VALUES < '2023-09-15T08:00:00.000000Z';
alter table __cq8kokxf_fgt_traffic add range partition '2023-09-15T08:00:00.000000Z' <= VALUES < '2023-09-15T16:00:00.000000Z';
alter table __cq8kokxf_fgt_traffic add range partition '2023-09-15T16:00:00.000000Z' <= VALUES < '2023-09-16T00:00:00.000000Z';
alter table __cq8kokxf_fgt_traffic add range partition '2023-09-16T00:00:00.000000Z' <= VALUES < '2023-09-16T08:00:00.000000Z';
alter table __cq8kokxf_fgt_traffic add range partition '2023-09-16T08:00:00.000000Z' <= VALUES < '2023-09-16T16:00:00.000000Z';
alter table __cq8kokxf_fgt_traffic add range partition '2023-09-16T16:00:00.000000Z' <= VALUES < '2023-09-17T00:00:00.000000Z';
alter table __cq8kokxf_fgt_traffic add range partition '2023-09-17T00:00:00.000000Z' <= VALUES < '2023-09-17T08:00:00.000000Z';
alter table __cq8kokxf_fgt_traffic add range partition '2023-09-17T08:00:00.000000Z' <= VALUES < '2023-09-17T16:00:00.000000Z';


__i4malgiu_facet_result


2023-09-09T16:00:00.000000Z <= VALUES < 2023-09-16T16:00:00.000000Z
2023-09-16T16:00:00.000000Z <= VALUES < 2023-09-17T00:00:00.000000Z

alter table __i4malgiu_facet_result drop range partition '2023-09-09T16:00:00.000000Z' <= VALUES < '2023-09-16T16:00:00.000000Z';
alter table __i4malgiu_facet_result drop range partition '2023-09-16T16:00:00.000000Z' <= VALUES < '2023-09-17T00:00:00.000000Z';


alter table __i4malgiu_facet_result add range partition '2023-09-09T16:00:00.000000Z' <= VALUES < '2023-09-10T00:00:00.000000Z';
alter table __i4malgiu_facet_result add range partition '2023-09-10T00:00:00.000000Z' <= VALUES < '2023-09-10T08:00:00.000000Z';
alter table __i4malgiu_facet_result add range partition '2023-09-10T08:00:00.000000Z' <= VALUES < '2023-09-10T16:00:00.000000Z';
alter table __i4malgiu_facet_result add range partition '2023-09-10T16:00:00.000000Z' <= VALUES < '2023-09-11T00:00:00.000000Z';
alter table __i4malgiu_facet_result add range partition '2023-09-11T00:00:00.000000Z' <= VALUES < '2023-09-11T08:00:00.000000Z';
alter table __i4malgiu_facet_result add range partition '2023-09-11T08:00:00.000000Z' <= VALUES < '2023-09-11T16:00:00.000000Z';
alter table __i4malgiu_facet_result add range partition '2023-09-11T16:00:00.000000Z' <= VALUES < '2023-09-12T00:00:00.000000Z';
alter table __i4malgiu_facet_result add range partition '2023-09-12T00:00:00.000000Z' <= VALUES < '2023-09-12T08:00:00.000000Z';
alter table __i4malgiu_facet_result add range partition '2023-09-12T08:00:00.000000Z' <= VALUES < '2023-09-12T16:00:00.000000Z';
alter table __i4malgiu_facet_result add range partition '2023-09-12T16:00:00.000000Z' <= VALUES < '2023-09-13T00:00:00.000000Z';
alter table __i4malgiu_facet_result add range partition '2023-09-13T00:00:00.000000Z' <= VALUES < '2023-09-13T08:00:00.000000Z';
alter table __i4malgiu_facet_result add range partition '2023-09-13T08:00:00.000000Z' <= VALUES < '2023-09-13T16:00:00.000000Z';
alter table __i4malgiu_facet_result add range partition '2023-09-13T16:00:00.000000Z' <= VALUES < '2023-09-14T00:00:00.000000Z';
alter table __i4malgiu_facet_result add range partition '2023-09-14T00:00:00.000000Z' <= VALUES < '2023-09-14T08:00:00.000000Z';
alter table __i4malgiu_facet_result add range partition '2023-09-14T08:00:00.000000Z' <= VALUES < '2023-09-14T16:00:00.000000Z';
alter table __i4malgiu_facet_result add range partition '2023-09-14T16:00:00.000000Z' <= VALUES < '2023-09-15T00:00:00.000000Z';
alter table __i4malgiu_facet_result add range partition '2023-09-15T00:00:00.000000Z' <= VALUES < '2023-09-15T08:00:00.000000Z';
alter table __i4malgiu_facet_result add range partition '2023-09-15T08:00:00.000000Z' <= VALUES < '2023-09-15T16:00:00.000000Z';
alter table __i4malgiu_facet_result add range partition '2023-09-15T16:00:00.000000Z' <= VALUES < '2023-09-16T00:00:00.000000Z';
alter table __i4malgiu_facet_result add range partition '2023-09-16T00:00:00.000000Z' <= VALUES < '2023-09-16T08:00:00.000000Z';
alter table __i4malgiu_facet_result add range partition '2023-09-16T08:00:00.000000Z' <= VALUES < '2023-09-16T16:00:00.000000Z';
alter table __i4malgiu_facet_result add range partition '2023-09-16T16:00:00.000000Z' <= VALUES < '2023-09-17T00:00:00.000000Z';
alter table __i4malgiu_facet_result add range partition '2023-09-17T00:00:00.000000Z' <= VALUES < '2023-09-17T08:00:00.000000Z';
alter table __i4malgiu_facet_result add range partition '2023-09-17T08:00:00.000000Z' <= VALUES < '2023-09-17T16:00:00.000000Z';


